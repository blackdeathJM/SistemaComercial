<article class="absolute inset-0 flex flex-auto flex-col p-4 overflow-hidden">
    <section class="relative flex consultas">
        <mat-form-field class="flex-auto">
            <mat-label>Filtrar empleados</mat-label>
            <input matInput [formControl]="ctrlBuscar" placeholder="Introduce el nombre de un empleado">
        </mat-form-field>
    </section>

    <section class="relative overflow-y-auto pt-2" ngxUiLoaderBlurred>
        <fuse-card class="flex flex-col flex-auto my-2 p-2" #fuseCard *ngFor="let empleado of entityEmpleado.entitiesArray$ | async">
            <div class="flex items-center">
                <span class="text-lg font-bold basis-1/5">{{empleado.nombreCompleto}}</span>
                <span class="basis-1/4">{{empleado?.deptoEmpleado?.nombre | defaultValue: '---'}}</span>
                <span class="basis-1/4">{{empleado?.puesto | defaultValue: '---'}}</span>
                <span class="grow">{{empleado?.auth?.usuario | defaultValue: '---'}}</span>
                <button mat-icon-button (click)="sesion(empleado)">
                    <mat-icon color="primary" [svgIcon]="empleado.auth === null? 'add': 'password'"></mat-icon>
                </button>
            </div>

            <div class="mt-3 -mx-3 border-t-2">
                <button class="px-3 mt-1" mat-button color="primary" (click)="fuseCard.expanded = !fuseCard.expanded">
                    <span class="mr-1">Permisos</span>
                    <mat-icon class="icon-size-5" *ngIf="!fuseCard.expanded" [svgIcon]="'heroicons_solid:chevron-down'"></mat-icon>
                    <mat-icon class="icon-size-5" *ngIf="fuseCard.expanded" [svgIcon]="'heroicons_solid:chevron-up'"></mat-icon>
                </button>
            </div>
            <ng-container fuseCardExpansion>
                <ng-container *ngIf="empleado.auth !== null && empleado.auth.usuario !== 'administrador'">
                    <section class="flex flex-auto flex-col">
                        <mat-list>
                            <mat-list-item *ngFor="let grupo of empleado.auth.role">
                                <div matListItemTitle class="flex flex-col flex-auto">
                                    <span class="flex-auto border-b-2">{{grupo['title']}}</span>
                                    <div class="flex flex-auto flex-col" matListItemLine *ngFor="let expandible of grupo.children">
                                        <span class="flex-auto">{{expandible['title']}}</span>
                                        <div class="flex flex-col flex-auto" matListItemLine *ngFor="let ruta of expandible.children">
                                            <div class="ml-8 flex flex-auto items-center justify-between">
                                                <span>{{ruta['title']}}</span>
                                                <mat-checkbox></mat-checkbox>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </mat-list-item>
                        </mat-list>
                    </section>
                </ng-container>
            </ng-container>
        </fuse-card>
        <ngx-ui-loader [loaderId]="ngxLoader"></ngx-ui-loader>
    </section>
</article>
