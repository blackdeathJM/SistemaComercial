<ng-container *ngIf="planeacionQuery.selectActive() | async as planeacion">
    <mat-card class="bg-gray-300 dark:bg-gray-800 m-4" @zoomIn>
        <mat-card-header class="tarjeta-mat-cabecera border-b-rose-500"><span>{{planeacion.descripcion}} --- {{planeacion.ano}}</span></mat-card-header>
        <mat-card-title>
            <mat-expansion-panel class="mb-4 border-b-cyan-400 border-b-2">
                <mat-expansion-panel-header class="border-b-2 border-b-cyan-400">
                    <mat-panel-title>Presupuesto basado en resultados</mat-panel-title>
                </mat-expansion-panel-header>
                <mat-button-toggle-group [tabIndex]="indice">
                    <div class="flex flex-auto flex-wrap">
                        <mat-button-toggle class="rounded-none" *ngFor="let pbr of cuestionariosPbr(); trackBy:trackByFn; let i=index" [value]="pbr" (change)="cambioDeSeleccion($event, i)">
                            <span class="text-left">{{pbr?.idIndicador}}</span>
                        </mat-button-toggle>
                    </div>
                </mat-button-toggle-group>
            </mat-expansion-panel>
        </mat-card-title>
        <mat-card-content>
            <section class="grid grid-cols-8 gap-4">
                <span class="border-b-2 text-xl text-green-600 text-center col-span-full">{{elementoPbr()?.idIndicador}}</span>
                <span class="detalle-span">Variable de origen</span>
                <span class="border-b-2">{{elementoPbr()?.variableOrigen}}</span>
                <span class="detalle-span">Dato</span>
                <span class="border-b-2 col-span-3">{{elementoPbr()?.dato | defaultValue: '---'}}</span>
                <span class="detalle-span">Unidad</span>
                <span class="border-b-2">{{elementoPbr()?.unidad | defaultValue: '---'}}</span>

                <span class="detalle-span">Descripcion</span>
                <span class="border-b-2 col-span-7">{{elementoPbr()?.descripcion}}</span>

                <span class="detalle-span">Enero</span>
                <span class="border-b-2">{{elementoPbr()?.enero | number: '1.0-2'}}</span>
                <span class="detalle-span">Febrero</span>
                <span class="border-b-2">{{ elementoPbr()?.febrero | number: '1.0-2' }}</span>
                <span class="detalle-span">Marzo</span>
                <span class="border-b-2">{{elementoPbr()?.marzo | number: '1.0-2'}}</span>
                <span class="detalle-span">Trimestre 1</span>
                <!--                        <span class="border-b-2">{{[pbr?.marzo, pbr?.febrero, pbr?.enero] | calculoPbr: pbr?.esSumatoriaTrim}}</span>-->
                <span class="border-b-2">{{elementoPbr()?.trim1 | number: '1.0-2'}}</span>

                <span class="detalle-span">Abril</span>
                <span class="border-b-2">{{elementoPbr()?.abril | number: '1.0-2'}}</span>
                <span class="detalle-span">Mayo</span>
                <span class="border-b-2">{{elementoPbr()?.mayo | number: '1.0-2'}}</span>
                <span class="detalle-span">Junio</span>
                <span class="border-b-2">{{elementoPbr()?.junio | number: '1.0-2'}}</span>
                <span class="detalle-span">Trimestre 2</span>
                <span class="border-b-2">{{elementoPbr()?.trim2 | number: '1.0-2'}}</span>


                <span class="detalle-span">Julio</span>
                <span class="border-b-2">{{elementoPbr()?.julio | number: '1.0-2'}}</span>
                <span class="detalle-span">Agosto</span>
                <span class="border-b-2">{{elementoPbr()?.agosto | number: '1.0-2'}}</span>
                <span class="detalle-span">Septiembre</span>
                <span class="border-b-2">{{elementoPbr()?.septiembre | number: '1.0-2'}}</span>
                <span class="detalle-span">Trimestre 3</span>
                <span class="border-b-2">{{elementoPbr()?.trim3 | number: '1.0-2'}}</span>


                <span class="detalle-span">Octubre</span>
                <span class="border-b-2">{{elementoPbr()?.octubre | number: '1.0-2'}}</span>
                <span class="detalle-span">Noviembre</span>
                <span class="border-b-2">{{elementoPbr()?.noviembre | number: '1.0-2'}}</span>
                <span class="detalle-span">Diciembre</span>
                <span class="border-b-2">{{elementoPbr()?.diciembre | number: '1.0-2'}}</span>
                <span class="detalle-span">Trimestre 4</span>
                <span class="border-b-2">{{elementoPbr()?.trim4 | number: '1.0-2'}}</span>

                <span class="detalle-span col-start-7">Acumulado final</span>
                <span class="border-b-2">{{elementoPbr()?.total | number: '1.0-2'}}</span>
            </section>
            <ngx-ui-loader [loaderId]="loader"></ngx-ui-loader>
        </mat-card-content>

        <mat-card-actions class="tarjeta-mat-acciones border-t-rose-500">
            <div class="flex flex-auto gap-4">
                <button class="flex-auto" mat-flat-button color="primary" [disabled]="desNuevoReg" (click)="nvoElemento()">
                    <mat-icon svgIcon="add"></mat-icon>
                    Nuevo registro
                </button>
                <button class="flex-auto" mat-flat-button color="accent" [disabled]="desEditarReg" (click)="editarPbr()">
                    <mat-icon svgIcon="edit"></mat-icon>
                    Editar registro
                </button>
                <button class="flex-auto" mat-flat-button color="warn" [disabled]="desEliminarReg" (click)="eliminarPbr()">
                    <mat-icon svgIcon="mat_outline:delete"></mat-icon>
                    Eliminar registro
                </button>
                <button mat-flat-button color="accent" class="flex-auto" (click)="regAvances()">
                    <mat-icon svgIcon="assignment"></mat-icon>
                    Registrar avances
                </button>
                <button mat-flat-button color="primary" class="flex-auto" (click)="cambiarDireccion('anterior')">
                    <mat-icon svgIcon="mat_solid:arrow_back"></mat-icon>
                    Anterior
                </button>
                <button mat-flat-button color="primary" class="flex-auto" (click)="cambiarDireccion('siguiente')">
                    Siguiente
                    <mat-icon svgIcon="mat_solid:arrow_forward"></mat-icon>
                </button>
                <button mat-flat-button color="accent" class="flex-auto">
                    <mat-icon svgIcon="heroicons_outline:printer"></mat-icon>
                    Imprimir
                </button>
            </div>
        </mat-card-actions>
    </mat-card>
</ng-container>
